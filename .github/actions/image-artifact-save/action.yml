name: "Save Image As Artifact"
description: "Save Built Docker Image as Artifact"
inputs:
  image:
    description: "file name"
    required: true
  artifact:
    description: "artifact path"
    required: true

outputs:
  file:
    description: "image stored as file name"
    value: ${{ steps.arguments.outputs.file }}

runs:
  using: "composite"
  steps:
    - name: Preparing Save Arguments
      shell: bash
      id: arguments
      run: |
        echo "::notice:: Preparing Save Arguments..."
        # cleanup image name 
        filename="${{ inputs.image }}"
        filename="${filename//\//-}"
        filename="${filename//./-}"
        filename="${filename//:/-}"
      
        # prepare filename
        filename="${filename}.tar"
      
        echo "::notice:: Arguments prepared."
        echo "file=$filename" >> $GITHUB_OUTPUT                

    - name: Save Docker Image
      id: image-save
      shell: bash
      run: |
        echo "::notice:: Saving Docker Image ${{ inputs.image }} as file..."
        image="${{ inputs.image }}"           
        file="${{ steps.arguments.outputs.file }}"
        
        # docker save -o $file $image
         
        echo "::notice:: Docker Image saved as $file."

#    - name: Upload Docker Image Artifact
#      uses: actions/upload-artifact@v4
#      with:
#        name: ${{ inputs.artifact }}
#        path: ${{ steps.arguments.outputs.file }}
#        if-no-files-found: error
